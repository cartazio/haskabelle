#!/bin/bash

function fail()
{
  echo "$1" >&2
  exit 2
}

EXECPATH="$(dirname "$0")/.."
SRC="$1"
DST="$2"

[ -z "$EXECPATH" ] && fail "$0 must be called with absolute path"
[ -z "$SRC" ] && fail "no source file given"
[ -z "$DST" ] && fail "no target dir given"

cd "$EXECPATH"

echo "Importing $SRC into $DST..."
ghc -fglasgow-exts -e "importFile \"$SRC\" \"$DST\"" Importer.hs || exit $?
