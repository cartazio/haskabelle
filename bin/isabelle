#!/bin/bash
#
# Author: Florian Haftmann, TU Muenchen
#
# Ephermal adapter script for isabelle vs. isatool.

## environment

HASKABELLE_HOME="$(cd "$(dirname "$0")"; cd "$(pwd -P)"; cd ..; pwd)"

echo "set: $ISABELLE_TOOL"

if [ -z "$ISABELLE_TOOL" ]
then
  if type -t isatool > /dev/zero
  then
    ISABELLE_TOOL="$(isatool getenv -b ISATOOL)"
  else
    ISABELLE_INVOKE_HOME="$(cd "$(dirname "$(type -p isabelle)")"; cd ..; cd "$(pwd -P)"; pwd)"
    if [ "$ISABELLE_INVOKE_HOME" == "$HASKABELLE_HOME" ]
    then
      echo "Cannot find isabelle executable on PATH=$PATH" >&2
      exit 2
    fi
    ISABELLE_TOOL="$(isabelle getenv -b ISABELLE_TOOL)"
  fi
fi

## execute

"$ISABELLE_TOOL" "$@" || exit $?
